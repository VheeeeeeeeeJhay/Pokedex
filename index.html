<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pokedex</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=search"
    />
  </head>
  <body
    class="flex flex-col justify-center items-center min-h-screen w-screen bg-yellow-400/40 p-4"
  >
    <div class="w-full max-w-4xl">
      <!-- Title -->
      <h1 class="text-center text-4xl sm:text-6xl lg:text-7xl font-bold mb-6">
        <span class="text-red-500">Poke</span
        ><span class="text-white">Search</span>
      </h1>

      <!-- Search form -->
      <!-- Search form -->
      <form
        class="flex flex-col sm:flex-row gap-3 justify-center items-center"
        onsubmit="return searchPokemon(event)"
      >
        <input
          id="pokemon-input"
          type="text"
          class="border border-gray-300 rounded-[20px] p-3 bg-white text-lg sm:text-2xl flex-1 w-full sm:w-auto"
          placeholder="Enter Pokemon name..."
          oninput="this.form.querySelector('button[type=submit]').disabled = this.value.trim() === ''"
        />
        <button
          type="submit"
          class="bg-blue-500 text-white rounded-[20px] px-6 py-3 hover:bg-blue-600 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"
          disabled
        >
          <span class="material-symbols-outlined text-3xl"> search </span>
        </button>
      </form>

      <!-- Notice -->
      <p
        class="mt-2 text-xs sm:text-sm font-bold text-red-500 text-center px-4"
      >
        *** Notice: When searching for Pokemon, please use the full name, e.g.
        <span class="italic">Pikachu</span>.
      </p>

      <!-- Error message -->
      <div
        id="pokemon-error"
        class="hidden mt-6 mx-auto text-center bg-red-500 text-white rounded-[20px] p-4 max-w-xl"
      >
        <p id="pokemon-error-message" class="text-sm sm:text-base"></p>
      </div>

      <!-- Pokemon card, render after search -->
      <div
        id="pokemon-card"
        class="hidden mt-8 mx-auto bg-white rounded-[20px] flex flex-col gap-6 max-w-1/3"
      >
        <div
          class="flex bg-red-500 w-full h-full justify-center items-center rounded-t-[20px] relative"
          id="pokemon-img-container"
        >
          <span id="pokemon-img-container-gradient" class="w-[100%] h-[40%] bg-red-500 absolute bottom-0 rounded-t-full"></span>
          <img
            id="pokemon-img"
            src=""
            alt=""
            class="w-40 h-40 object-contain sm:w-1/2 z-10"
          />
        </div>
        <div class="text-left space-y-2 z-10 bg-white p-4 rounded-b-[20px]">
          <p id="pokemon-id" class="text-lg sm:text-xl font-bold"></p>
          <p id="pokemon-name" class="text-lg sm:text-xl"></p>
          <p id="pokemon-type" class="text-lg sm:text-xl"></p>
        </div>
      </div>
    </div>

    <script>
      const typeColors = {
        normal: "bg-gray-400/60",
        fire: "bg-red-500/60",
        water: "bg-blue-500/60",
        electric: "bg-yellow-400/60",
        grass: "bg-green-500/60",
        ice: "bg-cyan-300/60",
        fighting: "bg-orange-700/60",
        poison: "bg-purple-500/60",
        ground: "bg-yellow-700/60",
        flying: "bg-indigo-300/60",
        psychic: "bg-pink-500/60",
        bug: "bg-lime-500/60",
        rock: "bg-stone-500/60",
        ghost: "bg-violet-700/60",
        dragon: "bg-indigo-700/60",
        dark: "bg-gray-800/60",
        steel: "bg-slate-400/60",
        fairy: "bg-pink-300/60",
        stellar: "bg-sky-400/60",
      };

      for (const [key, value] of Object.entries(typeColors)) {
        console.log(key, value);
      }
    
      const pokemonCard = document.getElementById("pokemon-card");
      const pokemonImgContainer = document.getElementById("pokemon-img-container");
      const pokemonImgContainerGradient = document.getElementById("pokemon-img-container-gradient");
    
      const pokemonError = document.getElementById("pokemon-error");
      const pokemonErrorMessage = document.getElementById("pokemon-error-message");
    
      function clearTypeColors(el) {
        Object.values(typeColors).forEach(cls => {
          cls.split(" ").forEach(token => el.classList.remove(token));
        });
        el.style.background = ""; // reset inline gradients too
      }
    
      function searchPokemon(event) {
        event.preventDefault();
        const pokemonName = document
          .querySelector("input")
          .value.toLowerCase()
          .trim();
    
        fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonName}`)
          .then((response) => response.json())
          .then((data) => {
            const { name, weight, sprites, id, types } = data;

        // Update image
        const img = document.getElementById("pokemon-img");
        img.src = sprites.front_default;
        img.alt = name;

        // Update text
        document.getElementById("pokemon-id").textContent = `#${id}`;
        document.getElementById("pokemon-name").textContent = name;
        // document.getElementById("pokemon-weight").textContent =
        //   weight + " lbs";

        const pokemonTypes = types.map((t) => t.type.name);

        // Show types
        // document.getElementById(
        //   "pokemon-gen"
        // ).textContent = `Types: ${pokemonTypes.join(", ")}`;
        const typeElement = document.getElementById("pokemon-type");
        typeElement.innerHTML = "";
        pokemonTypes.forEach((typeName) => {
          const typeBadge = document.createElement("span");
          typeBadge.className = `inline-block rounded-full px-3 py-1 text-sm font-semibold text-white mr-2 mb-2 ${typeColors[typeName] || "bg-gray-200"}`;
          typeBadge.textContent =
            typeName.charAt(0).toUpperCase() + typeName.slice(1);
          typeElement.appendChild(typeBadge);
        });

        // Apply background to span instead of container
        clearTypeColors(pokemonImgContainerGradient);

        if (pokemonTypes.length === 1) {
          pokemonImgContainerGradient.classList.add(
            typeColors[pokemonTypes[0]] || "bg-gray-200"
          );
        } else {
          // Use gradient for dual types
          const color1 =
            typeColors[pokemonTypes[0]]?.replace("bg-", "rgba(") || "rgba(128,128,128,0.4)";
          const color2 =
            typeColors[pokemonTypes[1]]?.replace("bg-", "rgba(") || "rgba(200,200,200,0.4)";
          pokemonImgContainerGradient.className =
            "w-[100%] h-[40%] absolute bottom-0 rounded-t-full";
          pokemonImgContainerGradient.style.background = `linear-gradient(135deg, ${color1}, ${color2})`;
        }

        pokemonCard.classList.remove("hidden");
        pokemonError.classList.add("hidden");
          })
          .catch((error) => {
            pokemonCard.classList.add("hidden");
            pokemonError.classList.remove("hidden");
            pokemonErrorMessage.textContent = `Pokemon "${pokemonName}" not found!`;
            setTimeout(() => {
              pokemonError.classList.add("hidden");
            }, 6000);
          });
      }
    </script>
    
  </body>
</html>
